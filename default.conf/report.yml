---
# Counter: Возвращает число подходящих строк после всех операций отсеивания
# поле: значение - выбрать только те строки, в которых данное поле идет с данным значением, для системных полей
# linedata:
#   name: value
#   ...
#   name: value - для определенных пользователем полей

# - Counter: "Неудачных попыток входа"
#   type: "Auth fail"

# - Counter:    "Total messages"
#   filename:   "/vvv/sshd.5"
#   server:     foo
#   service:    bar
#   type:       "Auth fail"
#   linedata:
#     username: baz
#     user_ip: 192.168.1.1

# - Distribution: "Messages by Users"
#   filename:   "/vvv/sshd.5"
#   server:     foo
#   service:    bar
#   type:       "Auth fail"
#   linedata:
#     username: baz
#   keys:
#   - username
#   - message
#   top: 100
#   sort_type: distinct




# Distribution: показывает распределение по полям. Либо хэш значение поля=>сколько раз встретилось,
# либо многоуровневый.
# Поля могут быть либо :server, :service, :type, либо пользовательские, но тогда они
#   указываются без двоеточия.
# поле: значение - отсеивание по значению полей до построения распределения
# :keys - по каким полям проводить агрегацию
# top - сколько результатов выводить
# sort_type -   total: по общему числу
#               distinct: по количеству различных значений


- Counter: "Сообщений отфильтровано"
  service: dovecot
  type: "Discard"
          #  -  count

- Counter: "Записано видео"
  service: motion
  type: "Motion"
          #  - motion

- Distribution: "Входов по pop3"
  service: dovecot
  type: "Logini-pop3"
  keys:
  - user_ip

- Distribution: "Какие IP подключались к нашим серверам"
  keys:
  - user_ip

- Distribution: "Распределение по событиям"
  keys:
  - type
  - user_ip

- Distribution: "Какие ip какие события вызывали"
  keys: 
  - user_ip
  - type
  top: 10
  sort_type: distinct

- Distribution: "Какие интересные имена пользователей пытаются подключиться"
  keys:
  - username
  sort_order: backward

- Distribution: "Какие ip какие имена используют"
  keys:
  - user_ip
  - username
  top: 50
  sort_type: distinct
