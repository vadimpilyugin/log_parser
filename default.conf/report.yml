---
# Counter: 
# Возвращает число после всех операций отсеивания
# server: отсеять по имени сервера
# service: отсеять по имени сервиса
# time: отсеять по времени
# type: отсеять по типу события
# except: отсеять те строки, в которых есть данное поле с данным значением

- Counter: "Сколько пользователей посетили сайт 10 октября"
  unique: user_ip
  :server: newserv
  :service: apache
  :time:
  - "10 Oct 2016"
  - "11 Oct 2016"

- Counter: "Сколько всего было запросов к сайту 10 октября"
  :service: apache
  :time:
  - "10 Oct 2016"
  - "11 Oct 2016"

- Counter: "Сколько было запросов к главной странице"
  :service: apache
  path: "/"

- Counter: "Неудавшихся попыток входа по ssh"
  :service: sshd
  :type: "Auth fail"

- Counter: "Успешных входов по ssh кроме autocheck"
  :service: sshd
  :type: "Accepted publickey"
  :except:
    username: autocheck

- Distribution: "Сколько всего разных IP подключалось к нашим серверам"
  keys: 
  - user_ip

# Distribution
#
# server
# service
# time
# type
# keys - по каким полям проводить агрегацию
# top - сколько результатов выводить
# sort_type -   total: по общему числу
#               distinct: по количеству различных значений

- Distribution: "Распределение по кодам ошибок"
  :service: apache
  :time:
  - "10 Oct 2016"
  - "11 Oct 2016"
  keys:
  - code

- Distribution: "Самые популярные страницы"
  :service: "apache"
  :time:
  - "10 Oct 2016"
  - "11 Oct 2016"
  keys:
  - path
  top: 5
  sort_type: total

- Distribution: "Какие ip в каких сервисах засветились"
  keys:
  - user_ip
  - :service
  top: 20
  sort_type: distinct

- Distribution: "Перебор серверов с ip"
  keys:
  - user_ip
  - :server
  top: 20
  sort_type: distinct

- Distribution: "Какие ip какие события вызывали"
  service: apache
  keys: 
  - user_ip
  - :descr
  top: 10
  sort_type: distinct
  except:
    username: autocheck