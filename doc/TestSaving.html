<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: TestSaving
  
    &mdash; Documentation by YARD 0.9.9
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "TestSaving";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (T)</a> &raquo;
    
    
    <span class="title">TestSaving</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: TestSaving
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Minitest::Test</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Minitest::Test</li>
          
            <li class="next">TestSaving</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>src/tests/test_db.rb<span class="defines">,<br />
  src/tests/test_db_1.rb,<br /> src/tests/test_services.rb,<br /> src/tests/test_log_templates.rb</span>
</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_coll-instance_method" title="#print_coll (instance method)">#<strong>print_coll</strong>(table)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_datas_coll-instance_method" title="#print_datas_coll (instance method)">#<strong>print_datas_coll</strong>(datas)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_kv-instance_method" title="#print_kv (instance method)">#<strong>print_kv</strong>(hsh = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_line-instance_method" title="#print_line (instance method)">#<strong>print_line</strong>(hsh = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup-instance_method" title="#setup (instance method)">#<strong>setup</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_aggregate_column-instance_method" title="#test_aggregate_column (instance method)">#<strong>test_aggregate_column</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_apache_log_format-instance_method" title="#test_apache_log_format (instance method)">#<strong>test_apache_log_format</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_apache_logline-instance_method" title="#test_apache_logline (instance method)">#<strong>test_apache_logline</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_count-instance_method" title="#test_count (instance method)">#<strong>test_count</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_fail2ban-instance_method" title="#test_fail2ban (instance method)">#<strong>test_fail2ban</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_fail2ban_log_format-instance_method" title="#test_fail2ban_log_format (instance method)">#<strong>test_fail2ban_log_format</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_first_line-instance_method" title="#test_first_line (instance method)">#<strong>test_first_line</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_load-instance_method" title="#test_load (instance method)">#<strong>test_load</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_log_format_finding-instance_method" title="#test_log_format_finding (instance method)">#<strong>test_log_format_finding</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_look_for_local-instance_method" title="#test_look_for_local (instance method)">#<strong>test_look_for_local</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_save_load_empty-instance_method" title="#test_save_load_empty (instance method)">#<strong>test_save_load_empty</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_saving-instance_method" title="#test_saving (instance method)">#<strong>test_saving</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_saving_big_log-instance_method" title="#test_saving_big_log (instance method)">#<strong>test_saving_big_log</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_sshd-instance_method" title="#test_sshd (instance method)">#<strong>test_sshd</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_sshd_not_found-instance_method" title="#test_sshd_not_found (instance method)">#<strong>test_sshd_not_found</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_syslog_log_format-instance_method" title="#test_syslog_log_format (instance method)">#<strong>test_syslog_log_format</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="print_coll-instance_method">
  
    #<strong>print_coll</strong>(table)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 27</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_coll'>print_coll</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_skip'>skip</span>
	<span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_print_line'>print_line</span> <span class='label'>line:</span> <span class='id identifier rubyid_line'>line</span><span class='comma'>,</span> <span class='label'>i:</span> <span class='id identifier rubyid_i'>i</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_datas_coll-instance_method">
  
    #<strong>print_datas_coll</strong>(datas)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41
42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 39</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_datas_coll'>print_datas_coll</span><span class='lparen'>(</span><span class='id identifier rubyid_datas'>datas</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_skip'>skip</span>
	<span class='id identifier rubyid_datas'>datas</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_elem'>elem</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
	  <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_print_kv'>print_kv</span><span class='lparen'>(</span><span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_kv-instance_method">
  
    #<strong>print_kv</strong>(hsh = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_kv'>print_kv</span><span class='lparen'>(</span><span class='id identifier rubyid_hsh'>hsh</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_skip'>skip</span>
  <span class='id identifier rubyid_hsh'>hsh</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_content'> = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_v'>v</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="print_line-instance_method">
  
    #<strong>print_line</strong>(hsh = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_line'>print_line</span><span class='lparen'>(</span><span class='id identifier rubyid_hsh'>hsh</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_skip'>skip</span>
  <span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:line</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:i</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='embexpr_end'>}</span><span class='tstring_content'>)\tFilename: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tLineNo: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_line'>line</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tData:\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_datas'>datas</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
    <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\tMeta:\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_metas'>metas</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
    <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\t\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'> = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup-instance_method">
  
    #<strong>setup</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


10
11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db.rb', line 10</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup'>setup</span>
  <span class='ivar'>@filename</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Tools.html" title="Tools (class)">Tools</a></span></span><span class='period'>.</span><span class='id identifier rubyid_abs_path'><span class='object_link'><a href="Tools.html#abs_path-class_method" title="Tools.abs_path (method)">abs_path</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>src/tests/files/auth_test</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@table</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Parser.html" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse!'><span class='object_link'><a href="Parser.html#parse!-class_method" title="Parser.parse! (method)">parse!</a></span></span><span class='lparen'>(</span><span class='ivar'>@filename</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>newserv</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_aggregate_column-instance_method">
  
    #<strong>test_aggregate_column</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 83</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_aggregate_column'>test_aggregate_column</span>
  <span class='id identifier rubyid_skip'>skip</span>
	<span class='id identifier rubyid_skip'>skip</span> <span class='kw'>unless</span> <span class='ivar'>@test_print</span>
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Все возможные коды и их частота: \n</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code</span><span class='tstring_end'>&quot;</span></span>
  <span class='comment'># a = Database::Data.all(name: &quot;code&quot;).aggregate(:all.count, :fields =&gt; [ :value ])
</span>  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='op'>::</span><span class='const'>Data</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_aggregate'>aggregate</span><span class='lparen'>(</span><span class='symbol'>:value</span><span class='comma'>,</span> <span class='symbol'>:all</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print_kv'>print_kv</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>
  <span class='comment'>#puts Database::Data.count value: &quot;/robots.txt&quot;
</span>  <span class='comment'>#printf &quot;#{Database::Data.aggregate(:name =&gt; &quot;code&quot;, :value)}\n&quot;
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_apache_log_format-instance_method">
  
    #<strong>test_apache_log_format</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_log_templates.rb', line 7</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_apache_log_format'>test_apache_log_format</span>
	<span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>93.180.9.50 - - [13/Feb/2017:07:22:52 +0300] \&quot;GET /pipermail/par-news/2012-December.txt.gz?uuid=123&amp;redirect=yandex.ru HTTP/1.0\&quot; 200 2015 \&quot;-\&quot; \&quot;Mozilla/5.0 (compatible;</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_assert'>assert</span> <span class='const'>ApacheFormat</span><span class='period'>.</span><span class='id identifier rubyid_check'>check</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>ApacheFormat</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbrace'>{</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user_ip</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>93.180.9.50</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>year</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>month</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Feb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>day</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>13</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hour</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>07</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>minute</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>22</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>second</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>52</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timezone</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>+0300</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>method</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>path</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/pipermail/par-news/2012-December.txt.gz</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http_version</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.0</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>200</span><span class='tstring_end'>&quot;</span></span>
	<span class='rbrace'>}</span>
	<span class='id identifier rubyid_true_result'>true_result</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
	  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> is wrong! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_apache_logline-instance_method">
  
    #<strong>test_apache_logline</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_services.rb', line 7</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_apache_logline'>test_apache_logline</span>
	<span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>93.180.9.182 - - [03/Feb/1997:18:30:00 +0300] \&quot;GET /robots.txt?uuid=180&amp;path=yandex.ru HTTP/1.0\&quot; 200 177 \&quot;-\&quot; \&quot;Wget/1.12 (linux-gnu)\&quot; - - newserv.srcc.msu.ru</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_service'>service</span> <span class='op'>=</span> <span class='const'>Services</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>apache</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
	<span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_check'>check</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbrace'>{</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
	  	<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>method</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GET</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  	<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>path</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/robots.txt</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  	<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user_ip</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>93.180.9.182</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  	<span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>200</span><span class='tstring_end'>&quot;</span></span>
	  <span class='rbrace'>}</span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>descr</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Connection information</span><span class='tstring_end'>&quot;</span></span>
	<span class='rbrace'>}</span>
	<span class='id identifier rubyid_true_result'>true_result</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
	  <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span>
	  	<span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k1'>k1</span><span class='comma'>,</span><span class='id identifier rubyid_v1'>v1</span><span class='op'>|</span>
	  	  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k1'>k1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k1'>k1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k1'>k1</span><span class='embexpr_end'>}</span><span class='tstring_content'> in data is wrong! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k1'>k1</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	  	<span class='kw'>end</span>
	  <span class='kw'>end</span>
	  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> is wrong! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_count-instance_method">
  
    #<strong>test_count</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 66</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_count'>test_count</span>
  <span class='id identifier rubyid_skip'>skip</span>
  <span class='id identifier rubyid_skip'>skip</span> <span class='kw'>unless</span> <span class='ivar'>@test_print</span>
  <span class='id identifier rubyid_key_str'>key_str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='op'>::</span><span class='const'>Data</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span> <span class='label'>name:</span> <span class='id identifier rubyid_key_str'>key_str</span>
  <span class='id identifier rubyid_hsh'>hsh</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Hash.html" title="Hash (class)">Hash</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_hash'>hash</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='op'>|</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='int'>0</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_data'>data</span><span class='op'>|</span>
	  <span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_puts'>puts</span>
  <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Counting </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key_str'>key_str</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>s: \n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_print_kv'>print_kv</span> <span class='id identifier rubyid_hsh'>hsh</span>
  <span class='id identifier rubyid_hsh'>hsh</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
	  <span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='op'>::</span><span class='const'>Data</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='lparen'>(</span><span class='label'>name:</span> <span class='id identifier rubyid_key_str'>key_str</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_fail2ban-instance_method">
  
    #<strong>test_fail2ban</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_services.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_fail2ban'>test_fail2ban</span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Log rotation detected for /var/log/auth.log</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Found 212.129.63.254</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Connection cannot be established</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='rbracket'>]</span>
  <span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_msg'>msg</span><span class='op'>|</span>
    <span class='const'>Services</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fail2ban</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_check'>check</span><span class='lparen'>(</span><span class='id identifier rubyid_msg'>msg</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>==</span> <span class='id identifier rubyid_result'>result</span>
  <span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>path</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/var/log/auth.log</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>descr</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Log rotation</span><span class='tstring_end'>&quot;</span></span>
    <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>descr</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ban/unban</span><span class='tstring_end'>&quot;</span></span>
    <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='kw'>nil</span>
  <span class='rbracket'>]</span>
  <span class='id identifier rubyid_true_result'>true_result</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_true_res'>true_res</span><span class='comma'>,</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_true_res'>true_res</span> <span class='op'>==</span> <span class='kw'>nil</span>
      <span class='id identifier rubyid_assert'>assert</span> <span class='const'>Services</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fail2ban</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='kw'>nil</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_true_res'>true_res</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
        <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='const'>Services</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fail2ban</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Got </span><span class='embexpr_beg'>#{</span><span class='const'>Services</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fail2ban</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span><span class='lparen'>(</span><span class='id identifier rubyid_str'>str</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>, expected </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_fail2ban_log_format-instance_method">
  
    #<strong>test_fail2ban_log_format</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_log_templates.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_fail2ban_log_format'>test_fail2ban_log_format</span>
	<span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017-02-14 04:22:15,208 fail2ban.actions        [1686]: NOTICE  [ssh] 223.99.60.47 already banned</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_assert'>assert</span> <span class='const'>Fail2BanFormat</span><span class='period'>.</span><span class='id identifier rubyid_check'>check</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>Fail2BanFormat</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbrace'>{</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>year</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>month</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>02</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>day</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>14</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hour</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>04</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>minute</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>22</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>second</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>15</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>msecond</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>208</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fail2ban</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>actions</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pid</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1686</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>level</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NOTICE</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>service</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ssh</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>msg</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>223.99.60.47 already banned</span><span class='tstring_end'>&quot;</span></span>
	<span class='rbrace'>}</span>
	<span class='id identifier rubyid_true_result'>true_result</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
	  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> is wrong! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_first_line-instance_method">
  
    #<strong>test_first_line</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49
50
51
52
53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 47</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_first_line'>test_first_line</span>
  <span class='id identifier rubyid_skip'>skip</span>
  <span class='id identifier rubyid_skip'>skip</span> <span class='kw'>unless</span> <span class='ivar'>@test_print</span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='op'>::</span><span class='const'>Logline</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='label'>line:</span> <span class='int'>1</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_a'>a</span>
  <span class='id identifier rubyid_print_line'>print_line</span> <span class='label'>line:</span> <span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='label'>i:</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_load-instance_method">
  
    #<strong>test_load</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_load'>test_load</span>
  <span class='id identifier rubyid_filename'>filename</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Tools.html" title="Tools (class)">Tools</a></span></span><span class='period'>.</span><span class='id identifier rubyid_abs_path'><span class='object_link'><a href="Tools.html#abs_path-class_method" title="Tools.abs_path (method)">abs_path</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>src/tests/files/auth_test.sqlite3</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_save!'><span class='object_link'><a href="Database.html#save!-class_method" title="Database.save! (method)">save!</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='ivar'>@table</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_table'>table</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load'><span class='object_link'><a href="Database.html#load-class_method" title="Database.load (method)">load</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
  <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='ivar'>@table</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>===============</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Было: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@table</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Стало: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_table'>table</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:date</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_table'>table</span> <span class='op'>==</span> <span class='ivar'>@table</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_log_format_finding-instance_method">
  
    #<strong>test_log_format_finding</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_log_templates.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_log_format_finding'>test_log_format_finding</span>
  <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>93.180.9.182 - - [13/Feb/2017:07:49:54 +0300] \&quot;GET / HTTP/1.0\&quot; 200 177 \&quot;-\&quot; \&quot;Wget/1.12 (linux-gnu)\&quot; - - newserv.srcc.msu.ru</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>141.8.142.23 - - [13/Feb/2017:07:58:40 +0300] \&quot;GET /MIU_XIX/images/memuary/tsvetaev/small/000ai.jpg HTTP/1.0\&quot; 304 - \&quot;-\&quot; \&quot;Mozilla/5.0 (compatible; YandexImages/3.0; +http://yandex.com/bots)\&quot; - - newserv.srcc.msu.ru</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>109.63.236.190 - - [13/Feb/2017:09:17:49 +0300] \&quot;GET /sites/all/modules/ctools/css/ctools.css?nhpgh0 HTTP/1.0\&quot; 200 252 \&quot;http://ccoe.msu.ru/ru/articles/openacc-intro\&quot; \&quot;Mozilla/5.0 (Windows NT 6.1; rv:26.0) Gecko/20100101 Firefox/26.0\&quot; - - cuda-center.parallel.ru</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>109.63.236.190 - - [13/Feb/2017:09:17:49 +0300] \&quot;GET /misc/drupal.js?nhpgh0 HTTP/1.0\&quot; 200 4976 \&quot;http://ccoe.msu.ru/ru/articles/openacc-intro\&quot; \&quot;Mozilla/5.0 (Windows NT 6.1; rv:26.0) Gecko/20100101 Firefox/26.0\&quot; - - cuda-center.parallel.ru</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Feb 13 06:47:41 newserv console-kit-daemon[1410]: (process:7337): GLib-CRITICAL **: g_slice_set_config: assertion &#39;sys_page_size == 0&#39; failed</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Feb 13 06:47:41 newserv systemd[1]: Started Session 169968 of user autocheck.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Feb 13 06:52:00 newserv systemd[25207]: Received SIGRTMIN+24 from PID 25221 (kill).</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017/02/13 08:58:10 [error] 25350#25350: *9502388 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 141.8.132.12, server: octoshell.ru, request: \&quot;GET /robots.txt HTTP/1.1\&quot;, upstream: \&quot;http://192.168.254.110:8080/robots.txt\&quot;, host: \&quot;www.octoshell.ru\&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017/02/13 09:06:10 [error] 25353#25353: *9502932 upstream timed out (110: Connection timed out) while reading response header from upstream, client: 93.158.152.38, server: octoshell.ru, request: \&quot;GET /robots.txt HTTP/1.1\&quot;, upstream: \&quot;http://192.168.254.110:8080/robots.txt\&quot;, host: \&quot;www.octoshell.ru\&quot;</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017-02-13 06:48:36,398 fail2ban.filter         [1686]: INFO    Log rotation detected for /var/log/exim4/mainlog</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017-02-13 08:34:34,191 fail2ban.filter         [1686]: INFO    [pam-generic] Found 212.129.63.254</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>2017-02-13 08:34:34,311 fail2ban.filter         [1686]: INFO    [ssh-ddos] Found 212.129.63.254</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='rbracket'>]</span>
  <span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbracket'>[</span>
    <span class='const'>ApacheFormat</span><span class='comma'>,</span>
    <span class='const'>ApacheFormat</span><span class='comma'>,</span>
    <span class='const'>ApacheFormat</span><span class='comma'>,</span>
    <span class='const'>ApacheFormat</span><span class='comma'>,</span>
    <span class='const'>SyslogFormat</span><span class='comma'>,</span>
    <span class='const'>SyslogFormat</span><span class='comma'>,</span>
    <span class='const'>SyslogFormat</span><span class='comma'>,</span>
    <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='kw'>nil</span><span class='comma'>,</span>
    <span class='const'>Fail2BanFormat</span><span class='comma'>,</span>
    <span class='const'>Fail2BanFormat</span><span class='comma'>,</span>
    <span class='const'>Fail2BanFormat</span>
  <span class='rbracket'>]</span>
  <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_logline'>logline</span><span class='comma'>,</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_assert'>assert</span> <span class='const'>LogFormat</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_logline'>logline</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrong log format! True: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>, got </span><span class='embexpr_beg'>#{</span><span class='const'>LogFormat</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_logline'>logline</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_look_for_local-instance_method">
  
    #<strong>test_look_for_local</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_look_for_local'>test_look_for_local</span>
  <span class='id identifier rubyid_skip'>skip</span>
  <span class='id identifier rubyid_skip'>skip</span> <span class='kw'>unless</span> <span class='cvar'>@@db_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>test.sqlite3</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='op'>::</span><span class='const'>Logline</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span> <span class='label'>datas:</span> <span class='lbrace'>{</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ip</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>217.69.133.29</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span> 
  <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span> <span class='label'>datas:</span> <span class='lbrace'>{</span><span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>code</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>404</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_refute_empty'>refute_empty</span> <span class='id identifier rubyid_a'>a</span> 
  <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span> <span class='id identifier rubyid_line'>line</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
	  <span class='id identifier rubyid_print_line'>print_line</span> <span class='label'>line:</span> <span class='id identifier rubyid_line'>line</span><span class='comma'>,</span> <span class='label'>i:</span> <span class='id identifier rubyid_i'>i</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_save_load_empty-instance_method">
  
    #<strong>test_save_load_empty</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36
37
38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db.rb', line 34</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_save_load_empty'>test_save_load_empty</span>
  <span class='id identifier rubyid_table'>table</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_filename'>filename</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Tools.html" title="Tools (class)">Tools</a></span></span><span class='period'>.</span><span class='id identifier rubyid_abs_path'><span class='object_link'><a href="Tools.html#abs_path-class_method" title="Tools.abs_path (method)">abs_path</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>src/tests/files/test.sqlite3</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_save!'><span class='object_link'><a href="Database.html#save!-class_method" title="Database.save! (method)">save!</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Saving was unsuccessful</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_table'>table</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_load'><span class='object_link'><a href="Database.html#load-class_method" title="Database.load (method)">load</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_table'>table</span> <span class='op'>==</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_saving-instance_method">
  
    #<strong>test_saving</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db_1.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_saving'>test_saving</span>
  <span class='const'><span class='object_link'><a href="Parser.html" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse!'><span class='object_link'><a href="Parser.html#parse!-class_method" title="Parser.parse! (method)">parse!</a></span></span>
  <span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Parser.html" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_saving_big_log-instance_method">
  
    #<strong>test_saving_big_log</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


14
15
16
17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_db.rb', line 14</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_saving_big_log'>test_saving_big_log</span>
  <span class='id identifier rubyid_skip'>skip</span>
	<span class='id identifier rubyid_table'>table</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Parser.html" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse!'><span class='object_link'><a href="Parser.html#parse!-class_method" title="Parser.parse! (method)">parse!</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Tools.html" title="Tools (class)">Tools</a></span></span><span class='period'>.</span><span class='id identifier rubyid_abs_path'><span class='object_link'><a href="Tools.html#abs_path-class_method" title="Tools.abs_path (method)">abs_path</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>src/tests/files/daemon.log</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>newserv</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
	<span class='id identifier rubyid_filename'>filename</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Tools.html" title="Tools (class)">Tools</a></span></span><span class='period'>.</span><span class='id identifier rubyid_abs_path'><span class='object_link'><a href="Tools.html#abs_path-class_method" title="Tools.abs_path (method)">abs_path</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>src/tests/files/daemon.sqlite3</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
	<span class='const'><span class='object_link'><a href="Database.html" title="Database (class)">Database</a></span></span><span class='period'>.</span><span class='id identifier rubyid_save!'><span class='object_link'><a href="Database.html#save!-class_method" title="Database.save! (method)">save!</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_sshd-instance_method">
  
    #<strong>test_sshd</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_services.rb', line 30</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_sshd'>test_sshd</span>
	<span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Connection from 192.168.0.1 port 666 on 127.0.0.1 port 1</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_service'>service</span> <span class='op'>=</span> <span class='const'>Services</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sshd</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
	<span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_check'>check</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span>
	<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbrace'>{</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user_ip</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>192.168.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user_port</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>666</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server_ip</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
   <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server_port</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>
	  <span class='rbrace'>}</span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>descr</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>New connection</span><span class='tstring_end'>&quot;</span></span>
	<span class='rbrace'>}</span>
	<span class='id identifier rubyid_true_result'>true_result</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
	  <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span>
	  	<span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k1'>k1</span><span class='comma'>,</span><span class='id identifier rubyid_v1'>v1</span><span class='op'>|</span>
	  	  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k1'>k1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k1'>k1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k1'>k1</span><span class='embexpr_end'>}</span><span class='tstring_content'> in data is wrong! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k1'>k1</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	  	<span class='kw'>end</span>
	  <span class='kw'>end</span>
	  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> is wrong! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_sshd_not_found-instance_method">
  
    #<strong>test_sshd_not_found</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_services.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_sshd_not_found'>test_sshd_not_found</span>
	<span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Connection to 192.168.0.1 on port 666 cannot be established</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>Services</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sshd</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='kw'>nil</span>
	<span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_syslog_log_format-instance_method">
  
    #<strong>test_syslog_log_format</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/tests/test_log_templates.rb', line 29</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_syslog_log_format'>test_syslog_log_format</span>
	<span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Feb 15 07:00:01 newserv CRON[18735]: (otrs) CMD ((test -x $HOME/bin/GenericAgent.pl &amp;&amp; $HOME/bin/GenericAgent.pl)||true &gt; /dev/null)</span><span class='tstring_end'>&quot;</span></span>
	<span class='id identifier rubyid_assert'>assert</span> <span class='const'>SyslogFormat</span><span class='period'>.</span><span class='id identifier rubyid_check'>check</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>SyslogFormat</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span> <span class='id identifier rubyid_s'>s</span>
	<span class='id identifier rubyid_true_result'>true_result</span> <span class='op'>=</span> <span class='lbrace'>{</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>month</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Feb</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>day</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>15</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hour</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>07</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>minute</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>00</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>second</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>01</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>server</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>newserv</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>service</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CRON</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pid</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>18735</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
	  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>msg</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(otrs) CMD ((test -x $HOME/bin/GenericAgent.pl &amp;&amp; $HOME/bin/GenericAgent.pl)||true &gt; /dev/null)</span><span class='tstring_end'>&quot;</span></span>
	<span class='rbrace'>}</span>
	<span class='id identifier rubyid_true_result'>true_result</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
	  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_true_result'>true_result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> is wrong! </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
	<span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Apr 25 10:57:48 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.9 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>