<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Parser
  
    &mdash; Documentation by YARD 0.9.9
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Parser";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (P)</a> &raquo;
    
    
    <span class="title">Parser</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Parser
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Parser</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>src/parser.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This class is used to parse incoming logs</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse!-class_method" title="parse! (class method)">.<strong>parse!</strong>(filename, server_name = &#39;n/a&#39;)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Парсит файл и возвращает результат в виде массива хэшей.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stats-class_method" title="stats (class method)">.<strong>stats</strong>(table)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Show statistics on parsed data.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stream_of_numbers-class_method" title="stream_of_numbers (class method)">.<strong>stream_of_numbers</strong>(table)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#transform-class_method" title="transform (class method)">.<strong>transform</strong>(input_file, output_file, type = true, server = &quot;n/a&quot;)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Transform log file into more readable form.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="parse!-class_method">
  
    .<strong>parse!</strong>(filename, server_name = &#39;n/a&#39;)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Парсит файл и возвращает результат в виде массива хэшей. Каждой строке
соответствует ровно один хэш в итоговом массиве. 
<pre class="code ruby"><code class="ruby">:server - имя сервера, строка, берется из входных параметров
:service - имя сервиса, который сделал данную запись в логе
:date - время записи в лог. Если отсуствует, берется текущее время
:type - описание данной записи. Берется из шаблона сервиса
:uid - уникальный номер регулярного выражения, под который подошла строка
        Равен 0, если строка подошла под формат лога, но не под сервис
&lt;другие ключи&gt; - сам пользователь выбирает им имена в шаблонах</code></pre>

<p> Если строка не подходит ни под один формат лога, то хэш будет содержать
три поля: uid, type и logline: 
<pre class="code ruby"><code class="ruby">&quot;logline&quot; =&gt; &lt;unknown_line&gt;
:type =&gt; &quot;Wrong format&quot;
:uid =&gt; -1</code></pre>

<p> Если строка подходит под формат лога, но не подходит ни под один сервис,
то поля data и type будут содержать следующие значения: 
<pre class="code ruby"><code class="ruby">&quot;logline&quot; =&gt; &lt;unknown line&gt;,
:type =&gt; &quot;Service not found&quot;
:uid =&gt; -2</code></pre>

<p> Если строка подошла под формат и сервис известен, но в нем не описан
шаблон, под который подошла бы строка, то поля data и type будут содержать 
следующие значения: 
<pre class="code ruby"><code class="ruby">&quot;logline&quot; =&gt; &lt;unknown line&gt;,
:type =&gt; &quot;Template not found&quot;
:uid =&gt; -3</code></pre>

<p></p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'>
<p>Нормальная строка</p>
</div></p>
      
      <pre class="example code"><code>Hash.new(
   :server =&gt; &quot;newserv&quot;, 
   :service =&gt; &quot;sshd&quot;, 
   :date =&gt; &lt;time&gt;, 
   :type =&gt; &quot;New connection&quot;, 
   :uid =&gt; 12345,
   &quot;user_ip&quot; =&gt; &quot;127.0.0.1&quot;,
   &quot;user_port&quot; =&gt; &quot;22&quot;
 )</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Не найден сервис</p>
</div></p>
      
      <pre class="example code"><code>Hash.new(
   :server =&gt; &quot;newserv&quot;, 
   :service =&gt; &quot;sshd&quot;, 
   :date =&gt; &lt;time&gt;, 
   :type =&gt; &quot;Service not found&quot;,
   &quot;logline&quot; =&gt; &lt;unknown message&gt;,
   :uid =&gt; -2
)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>Строка не подходит ни под один формат лога</p>
</div></p>
      
      <pre class="example code"><code>Hash.new(
  &quot;logline&quot; =&gt; &lt;unknown line&gt;,
  :type =&gt; &quot;Wrong format&quot;,
  :uid =&gt; -1
)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>filename</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>absolute path to log file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>server_name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;n/a&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>name of the remote server</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Error/FileNotFoundError.html" title="Error::FileNotFoundError (class)">Error::FileNotFoundError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if log file was not found</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/parser.rb', line 80</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='id identifier rubyid_server_name'>server_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n/a</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="Printer.html" title="Printer (class)">Printer</a></span></span><span class='op'>::</span><span class='id identifier rubyid_error'><span class='object_link'><a href="Printer.html#error-class_method" title="Printer.error (method)">error</a></span></span><span class='lparen'>(</span><span class='label'>msg:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Файл лога по пути </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_content'> не найден</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="Error.html" title="Error (module)">Error</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Error/FileNotFoundError.html" title="Error::FileNotFoundError (class)">FileNotFoundError</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_table'>table</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_log_format'>log_format</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_filename'>filename</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='const'><span class='object_link'><a href="Printer.html" title="Printer (class)">Printer</a></span></span><span class='op'>::</span><span class='id identifier rubyid_debug'><span class='object_link'><a href="Printer.html#debug-class_method" title="Printer.debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='label'>msg:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Файл лога успешно открыт: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_filename'>filename</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='label'>who:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Parser</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_logline'>logline</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
      <span class='const'><span class='object_link'><a href="Printer.html" title="Printer (class)">Printer</a></span></span><span class='op'>::</span><span class='id identifier rubyid_debug'><span class='object_link'><a href="Printer.html#debug-class_method" title="Printer.debug (method)">debug</a></span></span><span class='lparen'>(</span><span class='label'>who:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Обработано строк</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>msg:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_red'>red</span><span class='comma'>,</span> <span class='label'>in_place:</span><span class='kw'>true</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_log_format'>log_format</span> <span class='op'>==</span> <span class='kw'>nil</span>
        <span class='comment'># Формат лога определяется его первой строкой
</span>        <span class='id identifier rubyid_log_format'>log_format</span> <span class='op'>=</span> <span class='const'>LogFormat</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_logline'>logline</span><span class='rparen'>)</span>
        <span class='comment'># Если первая строка плохая, будет взята следующая и т.д. до 10 строки
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_log_format'>log_format</span> <span class='op'>==</span> <span class='kw'>nil</span>
          <span class='id identifier rubyid_table'>table</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span><span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrong format</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logline</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_logline'>logline</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>...</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:uid</span> <span class='op'>=&gt;</span> <span class='op'>-</span><span class='int'>1</span><span class='rbrace'>}</span>  <span class='comment'>#  убрать \n
</span>          <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>==</span> <span class='int'>10</span>
            <span class='kw'>break</span>
          <span class='kw'>else</span>
            <span class='kw'>next</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='comment'># Основной цикл: получить имя сервиса из формата лога, распарсить сообщение,
</span>      <span class='comment'># преобразовать дату и время в класс Ruby, записать результат в таблицу
</span>      <span class='id identifier rubyid_parsed_line'>parsed_line</span> <span class='op'>=</span> <span class='id identifier rubyid_log_format'>log_format</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span><span class='lparen'>(</span><span class='id identifier rubyid_logline'>logline</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span> <span class='op'>==</span> <span class='kw'>nil</span>
        <span class='id identifier rubyid_table'>table</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span><span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrong format</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logline</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_logline'>logline</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>...</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:uid</span> <span class='op'>=&gt;</span> <span class='op'>-</span><span class='int'>1</span><span class='rbrace'>}</span>
        <span class='kw'>next</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_service_name'>service_name</span> <span class='op'>=</span> <span class='id identifier rubyid_log_format'>log_format</span><span class='period'>.</span><span class='id identifier rubyid_get_service_name'>get_service_name</span><span class='lparen'>(</span><span class='id identifier rubyid_logline'>logline</span><span class='rparen'>)</span>
      <span class='comment'># Далее нужно парсить только часть строки лога или всю строку целиком?
</span>      <span class='comment'># Если есть поле msg, то оно берется в качестве части строки
</span>      <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>msg</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>msg</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='id identifier rubyid_logline'>logline</span>
      <span class='id identifier rubyid_service'>service</span> <span class='op'>=</span> <span class='const'>Services</span><span class='lbracket'>[</span><span class='id identifier rubyid_service_name'>service_name</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_uid'>uid</span> <span class='op'>=</span> <span class='int'>0</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_service'>service</span> <span class='op'>==</span> <span class='kw'>nil</span>
        <span class='comment'># Нет такого сервиса среди описанных =&gt; 
</span>        <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logline</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_message'>message</span><span class='rbrace'>}</span>
        <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Service not found</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_uid'>uid</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>2</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_parsed_msg'>parsed_msg</span> <span class='op'>=</span> <span class='const'>Services</span><span class='lbracket'>[</span><span class='id identifier rubyid_service_name'>service_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_parse!'>parse!</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_parsed_msg'>parsed_msg</span> <span class='op'>==</span> <span class='kw'>nil</span>
          <span class='comment'># Нет такого шаблона в сервисе
</span>          <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logline</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_message'>message</span><span class='rbrace'>}</span>
          <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Template not found</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_uid'>uid</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>3</span>
        <span class='kw'>else</span>
          <span class='comment'># Все хорошо, сообщение распарсено
</span>          <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_parsed_msg'>parsed_msg</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>data</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_parsed_msg'>parsed_msg</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>type</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_uid'>uid</span> <span class='op'>=</span> <span class='id identifier rubyid_parsed_msg'>parsed_msg</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>uid</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_date'>date</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="CreateDate.html" title="CreateDate (class)">CreateDate</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="CreateDate.html#create-class_method" title="CreateDate.create (method)">create</a></span></span><span class='lparen'>(</span>
        <span class='label'>year:</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>year</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='label'>month:</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>month</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='label'>day:</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>day</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='label'>hour:</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hour</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='label'>minute:</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>minute</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='label'>second:</span> <span class='id identifier rubyid_parsed_line'>parsed_line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>second</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
      <span class='rparen'>)</span>
      <span class='id identifier rubyid_table'>table</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span>
        <span class='symbol'>:server</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_server_name'>server_name</span><span class='comma'>,</span>
        <span class='symbol'>:service</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_service_name'>service_name</span><span class='comma'>,</span>
        <span class='symbol'>:date</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_date'>date</span><span class='comma'>,</span>
        <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
        <span class='symbol'>:uid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_uid'>uid</span>
      <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='const'><span class='object_link'><a href="" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_stats'><span class='object_link'><a href="#stats-class_method" title="Parser.stats (method)">stats</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_table'>table</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stats-class_method">
  
    .<strong>stats</strong>(table)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Show statistics on parsed data</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>table</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>see Parser::parse!</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/parser.rb', line 162</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_stats'>stats</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_st'>st</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Stats.html" title="Stats (module)">Stats</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Stats/Stats.html" title="Stats::Stats (class)">Stats</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Stats/Stats.html#initialize-instance_method" title="Stats::Stats#initialize (method)">new</a></span></span><span class='lparen'>(</span> <span class='lbracket'>[</span>
    <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Counter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>total_lines</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Всего прочитано строк</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Counter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>successfully_parsed</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Полностью распознанных</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Counter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ignored_services_lines</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Проигнорировано строк</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HashCounter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown_lines</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Строки, не подходящие под формат лога</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HashCounter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unrecognized_services</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Неопознанные сервисы</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HashCounter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>no_template_provided</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Строки, для которых не найдено шаблона</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HashCounter</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>services_distr</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Распределение по сервисам</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='rbracket'>]</span><span class='rparen'>)</span>    
  <span class='id identifier rubyid_puts'>puts</span>
  <span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
    <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_total_lines'>total_lines</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrong format</span><span class='tstring_end'>&quot;</span></span>
      <span class='comment'># Не распарсена, т.к. не подошла под формат
</span>      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_unknown_lines'>unknown_lines</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logline</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Service not found</span><span class='tstring_end'>&quot;</span></span>
      <span class='comment'># Подошла под формат, но сервис не был найден
</span>      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_unrecognized_services'>unrecognized_services</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_services_distr'>services_distr</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Template not found</span><span class='tstring_end'>&quot;</span></span>
      <span class='comment'># Подошла под сервис, но не нашлось шаблона
</span>      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_no_template_provided'>no_template_provided</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logline</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_services_distr'>services_distr</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ignore</span><span class='tstring_end'>&quot;</span></span>
      <span class='comment'># Полностью распознана, но проигнорирована
</span>      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_services_distr'>services_distr</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_successfully_parsed'>successfully_parsed</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span>
      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_ignored_services_lines'>ignored_services_lines</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span>
    <span class='kw'>else</span>
      <span class='comment'># Полностью распарсенная строка
</span>      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_services_distr'>services_distr</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span><span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_successfully_parsed'>successfully_parsed</span><span class='period'>.</span><span class='id identifier rubyid_increment'>increment</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_st'>st</span><span class='period'>.</span><span class='id identifier rubyid_print'>print</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stream_of_numbers-class_method">
  
    .<strong>stream_of_numbers</strong>(table)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


229
230
231
232
233
234
235
236
237
238
239
240
241</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/parser.rb', line 229</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_stream_of_numbers'>stream_of_numbers</span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_hash_table'>hash_table</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_i'>i</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hsh'>hsh</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_hash_table'>hash_table</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:uid</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_hash_table'>hash_table</span><span class='lbracket'>[</span><span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:uid</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_i'>i</span>
      <span class='id identifier rubyid_i'>i</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_hash_table'>hash_table</span><span class='lbracket'>[</span><span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:uid</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="transform-class_method">
  
    .<strong>transform</strong>(input_file, output_file, type = true, server = &quot;n/a&quot;)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Transform log file into more readable form</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input_file</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>filename of input log file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>server</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&quot;n/a&quot;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>name of the server from which the log file came from</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>bool</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if false then write only numbers to output log</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>output_file</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>filename of the output log file</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Error/FileNotFoundError.html" title="Error::FileNotFoundError (class)">Error::FileNotFoundError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if log file was not found</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'src/parser.rb', line 206</span>

<span class='kw'>def</span> <span class='const'><span class='object_link'><a href="" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_transform'>transform</span><span class='lparen'>(</span><span class='id identifier rubyid_input_file'>input_file</span><span class='comma'>,</span> <span class='id identifier rubyid_output_file'>output_file</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='op'>=</span><span class='kw'>true</span><span class='comma'>,</span> <span class='id identifier rubyid_server'>server</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n/a</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse!'><span class='object_link'><a href="#parse!-class_method" title="Parser.parse! (method)">parse!</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_input_file'>input_file</span><span class='comma'>,</span><span class='id identifier rubyid_server'>server</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_numbers'>numbers</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Parser (class)">Parser</a></span></span><span class='period'>.</span><span class='id identifier rubyid_stream_of_numbers'><span class='object_link'><a href="#stream_of_numbers-class_method" title="Parser.stream_of_numbers (method)">stream_of_numbers</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_f'>f</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_output_file'>output_file</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>w</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hsh'>hsh</span><span class='comma'>,</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_type'>type</span>
      <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='id identifier rubyid_numbers'>numbers</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_numbers'>numbers</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='op'>-</span><span class='int'>1</span> <span class='kw'>or</span> <span class='id identifier rubyid_numbers'>numbers</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='op'>-</span><span class='int'>2</span> <span class='kw'>or</span> <span class='id identifier rubyid_numbers'>numbers</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='op'>-</span><span class='int'>3</span>
        <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_numbers'>numbers</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t-\t(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>unknown</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>)::</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>logline</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_numbers'>numbers</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t-\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:service</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>::</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> ( </span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_hsh'>hsh</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_keep_if'>keep_if</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span> <span class='op'>==</span> <span class='const'><span class='object_link'><a href="String.html" title="String (class)">String</a></span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_hsh'>hsh</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'> : </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_printf'>printf</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> )\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Apr 24 23:47:03 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.9 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>